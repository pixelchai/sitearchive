function ParseFunction(n){console.log("Parsing Function from: "+n)}function printArray(n){for(var t=0;t<n.length;t++)Array.isArray(n[t])?printArray(n[t]):console.log(n[t])}function arrstr(n){output="";for(var t=0;t<n.length;t++)output+=typeof n[t]=="object"?"["+arrstr(n[t])+"]":n[t],t<n.length-1&&(output+=",");return output}function arrstrp(n){output="";for(var t=0;t<n.length;t++)typeof n[t]=="object"?output+=countchildren(n)>4?"("+arrstrp(n[t])+")":arrstrp(n[t]):typeof n[t]!="undefined"&&(output+=n[t]);return output}function countchildren(n){return childrencount=0,countchildrenrec(n),childrencount}function countchildrenrec(n){for(var t=0;t<n.length;t++)typeof n[t]=="object"?countchildrenrec(n[t]):childrencount++}function jsify(n){var t="";if(n.indexOf("^")>-1)t="Math.pow("+n.substr(0,n.indexOf("^"))+", "+n.substring(n.indexOf("^")+1,n.length)+")";else return n;console.log(n+" =(jsify)=> "+t)}function ParseArray(n){for(var i=[],r=arrstrp(n),t=0;t<n.length;t++)typeof n[t]=="object"?i.push(ParseArray(n[t])):i.push({text:{name:n[t]}});return{text:{name:r},children:i}}function DrawTree(n){var t=[];t.push({container:"#TreeContainer",scrollbar:"native"});t.push(ParseArray(n));new Treant(t)}function hasLetters(n){return/((?=[^\d])\w)/.test(n)}function hasNumbers(n){return/\d/.test(n)}function cleanArray(n){for(var i=[],t=0;t<n.length;t++)n[t]&&(typeof n[t]=="object"?n[t].length>0&&i.push(n[t]):i.push(n[t]));return i}function Split(n){var r=[],s,o,u,i,t;if(containsOperator(n))for(i="",u=0,t=0;t<n.length;t++)n[t]=="("?u++:n[t]==")"&&u--,u<=0&&isOperator(n[t])?(r.push(Split(i)),r.push(n[t]),i=""):(i+=n[t],t==n.length-1&&r.push(Split(i)));else if(containsPow(n)){var f=[],i="",u=0,e=!1;for(t=0;t<n.length;t++)e&&n[t]=="("?u++:e&&n[t]==")"&&(u--,u==0&&(f.push(Split(i)),r.push(f),s=Split(n.slice(t+1)),s!=""&&r.push(Split(s)))),n[t]=="^"?(o=Split(i),r.push(o.slice(0,-1)),f.push(o[o.length-1]),f.push("^"),i="",e=!0):e&&n[t]=="("||(i+=n[t])}else if(n.indexOf("(")>-1&&n.indexOf(")")>-1)if(n.indexOf("(")==0&&n.lastIndexOf(")")==n.length-1)console.log("sur!"),r.push(Split(n.slice(1,-1)));else for(i="",u=0,t=0;t<n.length;t++)n[t]=="("&&(u<=0&&i!=""&&(r.push(Split(i)),i=""),u++),i+=n[t],n[t]==")"?(u--,u<=0&&(r.push(Split(i)),i="")):t==n.length-1&&r.push(Split(i));else if(hasLetters)for(i="",t=0;t<n.length;t++)hasLetters(n[t])?(r.push([i.replace("(","").replace(")","")]),i="",r.push([n[t]])):(i+=n[t],t==n.length-1&&r.push([i.replace("(","").replace(")","")]));else r.push(n);return console.log(n+" =(Split)= "),r=cleanArray(r),console.log(r),r}function BracketSplit(n){for(var i=[],r=!1,u="",t=0;t<n.length;t++)n[t]=="("?r=!0:n[t]==")"?(r=!1,i.push(u),u=""):r&&(u+=n[t]);return console.log(i),i}function containsOperator(n){for(var i=0,t=0;t<n.length;t++)if(n[t]=="("?i++:n[t]==")"&&i--,i<=0&&isOperator(n[t]))return!0;return!1}function containsPow(n){for(var i=0,t=0;t<n.length;t++)if(n[t]=="("?i++:n[t]==")"&&i--,i<=0&&n[t]=="^")return!0;return!1}function isLetter(n){return n.toLowerCase()!=n.toUpperCase()}function isOperator(n){return operators.indexOf(n)>-1}var operators=["+","-","/","*"],childrencount;$("#input").on("input",function(){var n=$("#input").val();console.log("==========================================================");console.log(n);$("#TreeContainer").html("");DrawTree(Split(n))});childrencount=0;String.prototype.splice||(String.prototype.splice=function(n,t,i){return this.slice(0,n)+i+this.slice(n+Math.abs(t))})
