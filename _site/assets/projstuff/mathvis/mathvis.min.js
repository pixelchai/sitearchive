var operators=["+","-","/","*"];$("#input").on("input",function(a){a=$("#input").val();console.log("==========================================================");console.log(a);$("#TreeContainer").html("");DrawTree(Split(a))});function ParseFunction(a){console.log("Parsing Function from: "+a)}function printArray(a){for(var b=0;b<a.length;b++)Array.isArray(a[b])?printArray(a[b]):console.log(a[b])}
function arrstr(a){output="";for(var b=0;b<a.length;b++)output="object"==typeof a[b]?output+("["+arrstr(a[b])+"]"):output+a[b],b<a.length-1&&(output+=",");return output}function arrstrp(a){output="";for(var b=0;b<a.length;b++)"object"==typeof a[b]?output=4<countchildren(a)?output+("("+arrstrp(a[b])+")"):output+arrstrp(a[b]):"undefined"!=typeof a[b]&&(output+=a[b]);return output}var childrencount=0;function countchildren(a){childrencount=0;countchildrenrec(a);return childrencount}
function countchildrenrec(a){for(var b=0;b<a.length;b++)"object"==typeof a[b]?countchildrenrec(a[b]):childrencount++}function jsify(a){var b;if(-1<a.indexOf("^"))b="Math.pow("+a.substr(0,a.indexOf("^"))+", "+a.substring(a.indexOf("^")+1,a.length)+")";else return a;console.log(a+" =(jsify)=> "+b)}function ParseArray(a){for(var b=[],c=arrstrp(a),e=0;e<a.length;e++)"object"==typeof a[e]?b.push(ParseArray(a[e])):b.push({text:{name:a[e]}});return{text:{name:c},children:b}}
function DrawTree(a){var b=[];b.push({container:"#TreeContainer",scrollbar:"native"});b.push(ParseArray(a));new Treant(b)}function hasLetters(a){return/((?=[^\d])\w)/.test(a)}function hasNumbers(a){return/\d/.test(a)}function cleanArray(a){for(var b=[],c=0;c<a.length;c++)a[c]&&("object"==typeof a[c]?0<a[c].length&&b.push(a[c]):b.push(a[c]));return b}
function Split(a){var b=[];if(containsOperator(a))for(var c="",e=0,d=0;d<a.length;d++)"("==a[d]?e++:")"==a[d]&&e--,0>=e&&isOperator(a[d])?(b.push(Split(c)),b.push(a[d]),c=""):(c+=a[d],d==a.length-1&&b.push(Split(c)));else if(containsPow(a))for(var f=[],c="",e=0,g=!1,d=0;d<a.length;d++){if(g&&"("==a[d])e++;else if(g&&")"==a[d]&&(e--,0==e)){f.push(Split(c));b.push(f);var h=Split(a.slice(d+1));""!=h&&b.push(Split(h))}"^"==a[d]?(c=Split(c),b.push(c.slice(0,-1)),f.push(c[c.length-1]),f.push("^"),c="",
g=!0):g&&"("==a[d]||(c+=a[d])}else if(-1<a.indexOf("(")&&-1<a.indexOf(")"))if(0==a.indexOf("(")&&a.lastIndexOf(")")==a.length-1)console.log("sur!"),b.push(Split(a.slice(1,-1)));else for(c="",d=e=0;d<a.length;d++)"("==a[d]&&(0>=e&&""!=c&&(b.push(Split(c)),c=""),e++),c+=a[d],")"==a[d]?(e--,0>=e&&(b.push(Split(c)),c="")):d==a.length-1&&b.push(Split(c));else if(hasLetters)for(c="",d=0;d<a.length;d++)hasLetters(a[d])?(b.push([c.replace("(","").replace(")","")]),c="",b.push([a[d]])):(c+=a[d],d==a.length-
1&&b.push([c.replace("(","").replace(")","")]));else b.push(a);console.log(a+" =(Split)= ");b=cleanArray(b);console.log(b);return b}function BracketSplit(a){for(var b=[],c=!1,e="",d=0;d<a.length;d++)"("==a[d]?c=!0:")"==a[d]?(c=!1,b.push(e),e=""):c&&(e+=a[d]);console.log(b);return b}function containsOperator(a){for(var b=0,c=0;c<a.length;c++)if("("==a[c]?b++:")"==a[c]&&b--,0>=b&&isOperator(a[c]))return!0;return!1}
function containsPow(a){for(var b=0,c=0;c<a.length;c++)if("("==a[c]?b++:")"==a[c]&&b--,0>=b&&"^"==a[c])return!0;return!1}function isLetter(a){return a.toLowerCase()!=a.toUpperCase()}function isOperator(a){return-1<operators.indexOf(a)}String.prototype.splice||(String.prototype.splice=function(a,b,c){return this.slice(0,a)+c+this.slice(a+Math.abs(b))});